@using Models
@model Car
@{
    Layout = "~/Views/Shared/_AdminLayout.cshtml";
    ViewBag.Title = "New Car";

    string modelID = "", makeID = "", vehicleTrimID = "";
}

<p><span class="green">@ViewBag.Message</span></p>

@using (Html.BeginForm("UploadSmallImage", "CarManagement", FormMethod.Post, new { id = "frmUploadSmallImage", @novalidate = "novalidate", @class = "form-horizontal form-label-left", enctype = "multipart/form-data" }))
{
    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="flUploadSmallImage">
            Small Image
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            <input type="file" name="flUploadSmallImage" id="flUploadSmallImage" />
            <input type="submit" value="Upload" class="btn btn-primary" id="btnUploadSmallImage" />
        </div>
    </div>
}

@using (Html.BeginForm("UploadLargeImage", "CarManagement", FormMethod.Post, new { id = "frmUploadLargeImage", @novalidate = "novalidate", @class = "form-horizontal form-label-left", enctype = "multipart/form-data" }))
{
    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="flUploadLargeImage">
            Large Image
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            <input type="file" name="flUploadLargeImage" id="flUploadLargeImage" />
            <input type="submit" value="Upload" class="btn btn-primary" id="btnUploadLargeImage" />
        </div>
    </div>
}

@using (Html.BeginForm("InsertCar", "CarManagement", FormMethod.Post, new { @novalidate = "novalidate", @class = "form-horizontal form-label-left" }))
{
    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="MakeID">
            Make <span class="required">*</span>
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            <select class="form-control" id="MakeID" name="MakeID" required>
                <option value="">--Select--</option>
                @foreach (var item in ViewBag.MakeList)
                {
                    <option value="@item.MakeID.ToString()" @((!string.IsNullOrEmpty(makeID) && makeID == @item.MakeID.ToString() ? "selected" : ""))>
                        @item.Name
                    </option>
                }
            </select>
        </div>
    </div>
    
    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="ModelID">
            Model <span class="required">*</span>
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            <select class="form-control" id="ModelID" name="ModelID" required>
                <option value="" class="dontHide">--Select--</option>
                @if (string.IsNullOrEmpty(modelID))
                {
                    foreach (var item in ViewBag.ModelList)
                    {
                        <option value="@item.ModelID" data-parentid="@item.MakeID" class="hide">@item.Name</option>
                    }
                }
                else
                {
                    foreach (Models.Model item in ViewBag.ModelList)
                    {
                        <option value="@item.ModelID"
                                data-parentid="@item.MakeID"
                                class="@(item.MakeID.ToString() != makeID ? "hide" : "")"
                                @((!string.IsNullOrEmpty(modelID) && modelID == @item.ModelID.ToString() ? "selected" : ""))>
                            @item.Name
                        </option>
                    }
                }
            </select>
        </div>
    </div>
    
    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="VehicleTrimID">
            Vehicle Trim <span class="required">*</span>
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            <select class="form-control" id="VehicleTrimID" name="VehicleTrimID" required>
                <option value="" class="dontHide">--Select--</option>
                @if (string.IsNullOrEmpty(vehicleTrimID))
                {
                    foreach (var item in ViewBag.VehicleTrimList)
                    {
                        <option value="@item.VehicleTrimID" data-parentid="@item.ModelID" class="hide">@item.Name</option>
                    }
                }
                else
                {
                    foreach (Models.VehicleTrim item in ViewBag.VehicleTrimList)
                    {
                        <option value="@item.VehicleTrimID"
                                data-parentid="@item.ModelID"
                                class="@(item.ModelID.ToString() != modelID ? "hide" : "")"
                                @((!string.IsNullOrEmpty(modelID) && modelID == @item.ModelID.ToString() ? "selected" : ""))>
                            @item.Name
                        </option>
                    }
                }
            </select>
        </div>
    </div>

    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="Price">
            Price <span class="required">*</span>
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            @Html.TextBoxFor(m => m.Price, new { @class = "form-control", @required = "required", @type = "number" })
        </div>
    </div>

    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="Currency">
            Currency
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            @Html.DropDownListFor(m => m.CurrencyID, ViewBag.CurrencyList as SelectList, new { @class = "form-control" })
        </div>
    </div>

    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="BodyStyle">
            Body Style <span class="required">*</span>
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            @Html.TextBoxFor(m => m.BodyStyle, new { @class = "form-control", @required = "required" })
        </div>
    </div>

    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="Mileage">
            Mileage <span class="required">*</span>
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            @Html.TextBoxFor(m => m.Mileage, new { @class = "form-control", @required = "required", @type = "number" })
        </div>
    </div>
    
    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="Doors">
            Vin <span class="required">*</span>
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            @Html.TextBoxFor(m => m.vin, new { @class = "form-control", @required = "required" })
        </div>
    </div>

    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="Transmission">
            Transmission
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            @Html.DropDownListFor(m => m.Transmission, ViewBag.TransmissionList as SelectList, new { @class = "form-control", @required = "required" })
        </div>
    </div>

    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="Engine">
            Engine <span class="required">*</span>
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            @Html.TextBoxFor(m => m.Engine, new { @class = "form-control", @required = "required" })
        </div>
    </div>

    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="Drivetrain">
            Drive Train <span class="required">*</span>
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            <select class="form-control" id="Drivetrain" name="Drivetrain" required>
                <option>2WD</option>
                <option>4WD</option>
            </select>
        </div>
    </div>

    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="ExteriorColor">
            Exterior Color <span class="required">*</span>
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            @Html.TextBoxFor(m => m.ExteriorColor, new { @class = "form-control", @required = "required" })
        </div>
    </div>

    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="InteriorColor">
            Interior Color <span class="required">*</span>
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            @Html.TextBoxFor(m => m.InteriorColor, new { @class = "form-control", @required = "required" })
        </div>
    </div>

    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="Doors">
            Doors <span class="required">*</span>
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            @Html.TextBoxFor(m => m.Doors, new { @class = "form-control", @required = "required" })
        </div>
    </div>

    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="Conditon">
            Conditon
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            @Html.DropDownListFor(m => m.Conditon, ViewBag.ConditionList as SelectList, new { @class = "form-control", @required = "required" })
        </div>
    </div>

    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="Year">
            Year <span class="required">*</span>
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            @Html.TextBoxFor(m => m.Year, new { @class = "form-control", @required = "required", @type = "number" })
        </div>
    </div>

    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="Status">
            Status
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            @Html.DropDownListFor(m => m.Status, ViewBag.StatusList as SelectList, new { @class = "form-control", @required = "required" })
        </div>
    </div>

    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="Description">
            Description
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            @Html.TextAreaFor(m => m.Description, new { @class = "form-control" })
        </div>
    </div>

    <div class="item form-group">
        <label class="control-label col-md-3 col-sm-3 col-xs-12" for="StandardEquipment">
            Standard Equipment
        </label>
        <div class="col-md-6 col-sm-6 col-xs-12">
            @Html.TextAreaFor(m => m.StandardEquipment, new { @class = "form-control" })
        </div>
    </div>
    
    <div class="ln_solid"></div>
    <div class="form-group">
        <div class="col-md-6 col-md-offset-3 text-right">
            <button id="btnCancel" type="button" class="btn btn-danger" onclick="window.location.href='/CarManagement/Car'">Cancel</button>
            <button id="btnSubmit" type="submit" class="btn btn-success">Submit</button>
        </div>
    </div>
}

@section scripts {
    <script type="text/javascript">
        $(function () {
            $("#Name").focus();
            $("#carListItem").addClass("current-page");
            $("#carListItem").parent().css("display", "block");
            $("#carListItem").parent().parent().addClass("active");

            $("#btnUploadSmallImage").click(function () {
                var formData = new FormData();
                formData.append('file', $('#flUploadSmallImage')[0].files[0]);

                $.ajax({
                    url: '/CarManagement/UploadSmallImage',
                    type: 'POST',
                    data: formData,
                    processData: false,  // tell jQuery not to process the data
                    contentType: false,  // tell jQuery not to set contentType
                    success: function (data) {
                        alert("Small Image Uploaded Successfully");
                    }
                });

                return false;
            });

            $("#btnUploadLargeImage").click(function () {
                var formData = new FormData();
                formData.append('file', $('#flUploadLargeImage')[0].files[0]);

                $.ajax({
                    url: '/CarManagement/UploadLargeImage',
                    type: 'POST',
                    data: formData,
                    processData: false,  // tell jQuery not to process the data
                    contentType: false,  // tell jQuery not to set contentType
                    success: function (data) {
                        alert("Large Image Uploaded Successfully");
                    }
                });

                return false;
            });
        })

        $('form').submit(function (e) {
            e.preventDefault();
            var submit = true;

            // evaluate the form using generic validaing
            if (!validator.checkAll($(this))) {
                submit = false;
            }

            if (submit)
                this.submit();

            return false;
        });
    </script>
}